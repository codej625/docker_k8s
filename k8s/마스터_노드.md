# 마스터 노드 (Control Plane Node)

<br />
<br />

* 쿠버네티스 클러스터 전체를 관리하고 제어하는 두뇌 역할
---

```
쿠버네티스 클러스터는 마스터 노드와 워커 노드 이렇게 두 종류의 노드로 구성된다.

워커 노드는 우리가 만든 애플리케이션이 실제로 돌아가는 곳이다.

마스터 노드는 워커 노드들이 어디에 어떤 파드를 띄울지 결정하고,
모든 설정과 상태를 저장하며, 클러스터 전체를 통제하는 두뇌 역할을 한다.

마스터 노드가 죽으면 워커 노드가 아무리 많고 건강해도 클러스터 전체가 멈추기 때문에,
현업에서는 절대 사용자 애플리케이션을 올리지 않고,
반드시 3개 이상(홀수)으로 고가용성(HA) 구성을 한다.

결국 워커 노드는 "몸"이고 마스터 노드는 "머리"라고 이해하면 된다.
```

<br />
<br />
<br />
<br />


1. 마스터 노드의 구조 (왜 3개여야 하는지 핵심 이유)

```
하나의 마스터 노드가 죽어도,
나머지 2개가 살아서 클러스터가 계속 정상 작동한다.

이렇게 보면 애초에 2개여도 하나가 살면 되지 않나 싶지만
마스터 노드는 반드시 홀수로 구성해야 한다.

마스터 노드 안에는 etcd라는 분산 데이터베이스가 들어가 있는데,
etcd는 반드시 ‘과반수(Quorum)’가 살아 있어야 동작한다.

그렇기 때문에 마스터 노드가 2개인 상황에서는 서로 과반수 투표를 못 해서
작동하지 않고 최소 2:1의 상황이어야 리더로 하나의 마스터를 세우고 작동한다.
```

<br />
<br />
<br />

2. 마스터 노드(Control Plane) 핵심 구성 요소

| 구성 요소                    | 역할 (한 줄 요약)                                      | 죽으면 어떤 일이 생기나?                    |
|------------------------------|-------------------------------------------------------|-----------------------------------------------|
| **kube-apiserver**           | 모든 kubectl 명령과 API 요청이 들어오는 유일한 입구    | 클러스터와 완전 단절 (kubectl도 안 먹힘)       |
| **etcd**                     | 클러스터의 모든 상태·설정·시크릿 등을 저장하는 분산 DB | 클러스터 사실상 사망 (데이터 읽고 쓰기 불가능) |
| **kube-scheduler**           | 새로 생성된 파드를 어느 워커 노드에 배치할지 결정      | 새 파드가 영원히 Pending 상태로 남음           |
| **kube-controller-manager**  | Deployment, ReplicaSet, Node 등의 원하는 상태 유지    | 파드 자동 복구 안 됨, 노드 장애 감지도 안 됨   |
| **cloud-controller-manager** | AWS/GCP/Azure 등 클라우드 리소스와 연동 (선택적)      | 로드밸런서·볼륨 등 클라우드 기능만 동작 안 함   |

<br />

```
* 핵심 정리

apiserver = 문지기

etcd = 금고

scheduler = 배치 담당

controller-manager = 감시·복구
```
